
version: 2

models:
  - name: int_retail__orders
    description: "intermediate model for retail orders"
    columns:
      - name: order_id
        description: "The primary key for this table"
        data_tests:
          - unique
          - not_null
      - name: order_id
      - name: customer_id
      - name: order_status
        data_tests:
          - accepted_values:
              arguments:
                values: ["COMPLETE","PENDING","CLOSED","SUSPECTED FRAUD"]
      - name: order_timestamp
      - name: order_date
      - name: order_year
      - name: order_month_name
      - name: order_month_num
      - name: order_week_of_year
      - name: order_day_of_month
      - name: order_day_name
      - name: order_day_of_week_num
      - name: etl_load_timestamp
  - name: int_retail__order_items
    description: intermediate layer for retail order_items
    columns:
      - name: order_item_id
        data_tests:
          - unique
          - not_null
      - name: order_id
        data_tests:
          - relationships:
              arguments:
                to: ref('int_retail__orders')
                field: order_id
      - name: product_id
      - name: quantity
      - name: subtotal
      - name: product_price 
  - name: int_retail__customers
    description: 'intermediate layer for retail customers'
    columns:
      - name: customer_id
        description: "The primary key for this table"
        data_tests:
          - unique
          - not_null
      - name: first_name
      - name: last_name
      - name: full_name
      - name: street
      - name: city
      - name: state
      - name: zipcode
  - name: int_retail__products
    description: "Intermediate table for retail products"
    columns:
      - name: product_id
        description: "The primary key for the product table"
        data_tests:
          - unique
          - not_null
      - name: category_id
      - name: product_name
      - name: product_price
      - name: etl_load_timestam
  - name: int_retail__departments
    description: "Intermediate table for retail departments"
    columns:
      - name: department_id
        description: "The primary key for the product table"
        data_tests:
          - unique
          - not_null
      - name: department_name
      - name: etl_load_timestam
  - name: int_retail__categories
    description: "Intermediate table for retail categories"
    columns:
      - name: category_id
        description: "The primary key for the product table"
        data_tests:
          - unique
          - not_null
      - name: department_id
      - name: category_name
      - name: etl_load_timestamp
  - name: int_fact_sales
    description: "Intermediate fact_sales table"
    columns:
      - name: order_item_id
      - name: product_id
      - name: order_id
      - name: customer_id
      - name: quantity
      - name: total_revenue
      - name: product_price
      - name: order_status
      - name: order_timestamp
  - name: int_dim_product
    description: "Intermediate product dimension table"
    columns:
      - name: product_id
      - name: product_name
      - name: category_id
      - name: category_name
      - name: department_id
      - name: department_name
      - name: product_price
      - name: etl_load_timestamp
  # - name: int_dim_order_totals
  #   description: "Intermediate order_totals dimension table"
  #   columns:
  #     - name: order_id
  #     - name: total_order_value
